<Window x:Class="WordKiller.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:typeXaml="clr-namespace:WordKiller.DataTypes.TypeXAML"
        xmlns:vm="clr-namespace:WordKiller.ViewModels"
        mc:Ignorable="d"
        Name="win"
        Title="{Binding Path=WinTitle,Mode=TwoWay}" Height="447" Width="695" MinHeight="310" MinWidth="710" DragOver="Win_DragOver" DragLeave="Win_DragLeave" AllowDrop="True" DragEnter="Win_DragEnter" Icon="/Resources/Pictures/512x512.png">
    <Window.DataContext>
        <vm:ViewModelMain/>
    </Window.DataContext>
    <Window.InputBindings>
        <KeyBinding Command="SaveAs" Key="S" Modifiers="Control+Alt"/>
        <KeyBinding Command="Close" Key="Q" Modifiers="Control"/>
        <KeyBinding Command="Undo" Key="Esc"/>
    </Window.InputBindings>
    <Window.CommandBindings>
        <CommandBinding Command="New" Executed="WindowBinding_New" />
        <CommandBinding Command="Open" Executed="WindowBinding_Open" />
        <CommandBinding Command="Save" Executed="WindowBinding_Save" />
        <CommandBinding Command="SaveAs" Executed="WindowBinding_SaveAs"/>
        <CommandBinding Command="Close" Executed="WindowBinding_Quit" />
        <CommandBinding Command="Undo" Executed="CommandBinding_Executed"/>
    </Window.CommandBindings>
    <Grid Background="{Binding Path=MainColor,Mode=TwoWay}" x:Name="ParentPanel">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" Grid.Column="0" x:Name="MainPanel">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Menu x:Name="MenuPanel" Grid.Row="0" Grid.Column="0" Style="{StaticResource Menu}">
                <MenuItem>
                    <MenuItem.Header>
                        <TextBlock Text="{DynamicResource File}" Style="{StaticResource TextBlockMenu}"/>
                    </MenuItem.Header>
                    <MenuItem Header="{DynamicResource Export}" Style="{StaticResource MenuItem}" Click="Export_MI_Click"/>
                    <MenuItem Header="{DynamicResource PDF}" x:Name="ExportPDF" Style="{StaticResource MenuItem}" Click="ExportPDF_MI_Click"/>
                    <MenuItem Header="{DynamicResource HTML}" x:Name="ExportHTML" Style="{StaticResource MenuItem}" Click="ExportHTML_MI_Click" />
                    <Separator/>
                    <MenuItem Header="{DynamicResource Create}" Command="New" Style="{StaticResource MenuItem}"/>
                    <MenuItem Header="{DynamicResource Open}" Command="Open" Style="{StaticResource MenuItem}"/>
                    <MenuItem Header="{DynamicResource Save}" Command="Save" Style="{StaticResource MenuItem}"/>
                    <MenuItem Header="{DynamicResource SaveAs}" Command="SaveAs" InputGestureText="Ctrl+Alt+S" Style="{StaticResource MenuItem}"/>
                    <Separator/>
                    <MenuItem Header="{DynamicResource Exit}" Command="Close" InputGestureText="Ctrl+Q" Style="{StaticResource MenuItem}"/>
                </MenuItem>
                <MenuItem>
                    <MenuItem.Header>
                        <TextBlock Text="{DynamicResource View}" Style="{StaticResource TextBlockMenu}"/>
                    </MenuItem.Header>
                    <MenuItem Header="{DynamicResource Title}" IsChecked="{Binding Path=TitleOpen,Mode=TwoWay}" x:Name="TitlePageMI" Style="{StaticResource MenuItem}" Click="View_MI_Click"/>
                    <MenuItem Header="{DynamicResource Substitution}"  IsChecked="{Binding Path=SubstitutionOpen,Mode=TwoWay}" x:Name="SubstitutionMI" Style="{StaticResource MenuItem}" Click="View_MI_Click"/>
                    <MenuItem Header="{DynamicResource Text}" IsChecked="{Binding Path=TextOpen,Mode=TwoWay}" x:Name="TextMI"  Style="{StaticResource MenuItem}" Click="View_MI_Click"/>
                </MenuItem>
                <MenuItem>
                    <MenuItem.Header>
                        <TextBlock Text="{DynamicResource Document}" Style="{StaticResource TextBlockMenu}"/>
                    </MenuItem.Header>
                    <MenuItem Header="{DynamicResource Type}" Style="{StaticResource MenuItem}" x:Name="typeMenuItem">
                        <MenuItem x:Name="DefaultDocumentMI" Header="{DynamicResource DefaultDocument}" IsChecked="True" Style="{StaticResource MenuItem}" Click="DocumentType_MI_Click"/>
                        <Separator/>
                        <MenuItem x:Name="CourseworkMI" Header="{DynamicResource Coursework}" Style="{StaticResource MenuItem}" Click="DocumentType_MI_Click"/>
                        <Separator/>
                        <MenuItem x:Name="LaboratoryWorkMI" Header="{DynamicResource LaboratoryWork}" Style="{StaticResource MenuItem}" Click="DocumentType_MI_Click"/>
                        <MenuItem x:Name="PracticeWorkMI" Header="{DynamicResource PracticeWork}" Style="{StaticResource MenuItem}" Click="DocumentType_MI_Click"/>
                        <Separator/>
                        <MenuItem x:Name="ControlWorkMI" Header="{DynamicResource ControlWork}" Style="{StaticResource MenuItem}" Click="DocumentType_MI_Click"/>
                        <MenuItem x:Name="ReferatMI" Header="{DynamicResource Referat}" Style="{StaticResource MenuItem}" Click="DocumentType_MI_Click"/>
                        <Separator/>
                        <MenuItem x:Name="DiplomaMI" Header="{DynamicResource DiplomaWork}" Style="{StaticResource MenuItem}" Click="DocumentType_MI_Click"/>
                        <MenuItem x:Name="VKRMI" Header="{DynamicResource VKR}" Style="{StaticResource MenuItem}" Click="DocumentType_MI_Click"/>
                    </MenuItem>
                    <Separator/>
                    <MenuItem Header="{DynamicResource PageNumbers}" IsCheckable="True" IsChecked="{Binding Path=Properties.PageNumbers, Mode=TwoWay}" Style="{StaticResource MenuItem}"/>
                    <MenuItem Header="{DynamicResource TOC}" IsCheckable="True" IsChecked="{Binding Path=Properties.TableOfContents, Mode=TwoWay}" Style="{StaticResource MenuItem}"/>
                    <MenuItem Header="{DynamicResource NumbersToHeaders}" IsChecked="{Binding Path=Properties.NumberHeading, Mode=TwoWay}" Style="{StaticResource MenuItem}" Click="NumberHeading_MI_Click"/>
                </MenuItem>
                <MenuItem Visibility="Collapsed">
                    <MenuItem.Header>
                        <TextBlock Text="{DynamicResource Network}" Style="{StaticResource TextBlockMenu}"/>
                    </MenuItem.Header>
                    <MenuItem Header="Создать" Style="{StaticResource MenuItem}" Click="CreateNetwork"/>
                    <Separator/>
                    <MenuItem Header="Подключиться" Style="{StaticResource MenuItem}" Click="JoinNetwork"/>
                    <MenuItem Header="Отключиться" Style="{StaticResource MenuItem}" Click="LeaveNetwork"/>
                </MenuItem>
                <MenuItem>
                    <MenuItem.Header>
                        <TextBlock Text="Разное" Style="{StaticResource TextBlockMenu}"/>
                    </MenuItem.Header>
                    <MenuItem Header="Поменять пользователя" Style="{StaticResource MenuItem}" Click="ChangeUser_MI_Click"/>
                </MenuItem>
                <MenuItem>
                    <MenuItem.Header>
                        <TextBlock Text="{DynamicResource Help}" Style="{StaticResource TextBlockMenu}"/>
                    </MenuItem.Header>
                    <MenuItem Header="{DynamicResource Documentation}" Style="{StaticResource MenuItem}" Click="DocumentationShow"/>
                    <Separator/>
                    <MenuItem Header="{DynamicResource AboutProgram}" Style="{StaticResource MenuItem}" Click="AboutProgramShow"/>
                </MenuItem>
            </Menu>
            <Button Margin="0,0,53,0" x:Name="SwitchPanel" HorizontalAlignment="Right" Content="К титульнику" Visibility="Collapsed" Style="{StaticResource Button1}" Click="SwitchPanel_Click"/>
            <Button Margin="0,0,3,0" HorizontalAlignment="Right" Style="{StaticResource Button1}" Click="OpenSettings_Click">
                <Image Width="20" Height="20" Source="/Resources/Pictures/Settings.png"/>
            </Button>
            <Image x:Name="saveLogo" Width="20" Height="20" Margin="0,0,28,0" Source="/Resources/Pictures/512x512.png" HorizontalAlignment="Right" Visibility="Collapsed"/>
            <Grid x:Name="titlePanel" Grid.Row="1" Grid.Column="0" Margin="30,10,30,10" Background="{Binding Path=MainColor,Mode=TwoWay}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="20*"/>
                    <ColumnDefinition Width="16*"/>
                    <ColumnDefinition Width="16*"/>
                    <ColumnDefinition Width="16*"/>
                    <ColumnDefinition Width="16*"/>
                    <ColumnDefinition Width="16*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="10*"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="10*"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Grid.Column="0" Margin="0,10,10,5" Text="Кафедра:" Style="{StaticResource TextBlockTitle}"/>
                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="facultyComboBox" Text="{Binding Path=Title.Faculty,Mode=TwoWay}"  Margin="10,10,10,5" SelectedItem="информационных систем и цифровых технологий" Style="{StaticResource ComboBox}" SelectionChanged="FacultyComboBox_SelectionChanged">
                    <ComboBoxItem IsSelected="True">информационных систем и цифровых технологий</ComboBoxItem>
                    <ComboBoxItem>приборостроения, метрологии и сертификации</ComboBoxItem>
                    <ComboBoxItem>информационной безопасности</ComboBoxItem>
                    <ComboBoxItem>технической физики и математики</ComboBoxItem>
                    <ComboBoxItem>электроники, радиотехники и систем связи</ComboBoxItem>
                    <ComboBoxItem>электрооборудования и энергосбережения</ComboBoxItem>
                </ComboBox>
                <TextBlock Grid.Row="1" Grid.Column="0" Margin="0,5,10,10" Text="Выполнил(и):" Style="{StaticResource TextBlockTitle}"/>
                <TextBox Grid.Row="1" Grid.Column="1" x:Name="studentsTextBox" Text="{Binding Path=Title.Students,Mode=TwoWay}" Margin="10,5,10,10" Style="{StaticResource TextBox}"/>
                <TextBlock Grid.Row="1" Grid.Column="2" Margin="0,5,10,10" Text="№" Style="{StaticResource TextBlockTitle}"/>
                <TextBox Grid.Row="1" Grid.Column="3" x:Name="numberTextBox" Text="{Binding Path=Title.Number,Mode=TwoWay}" Margin="10,5,10,10" Style="{StaticResource TextBox}"/>
                <TextBlock Grid.Row="1" Grid.Column="4" Margin="0,5,10,10" Text="{DynamicResource Shifr}" Style="{StaticResource TextBlockTitle}"/>
                <TextBox Grid.Row="1" Grid.Column="5" x:Name="shifrTextBox" Text="{Binding Path=Title.Shifr,Mode=TwoWay}" Margin="10,5,10,10" Style="{StaticResource TextBox}"/>
                <TextBlock Grid.Row="3" Grid.Column="0" Margin="0,10,10,5" Text="Тема:" Style="{StaticResource TextBlockTitle}"/>
                <TextBox Grid.Row="3" Grid.Column="1" x:Name="themeTextBox" Text="{Binding Path=Title.Theme,Mode=TwoWay}"  Margin="10,10,10,5" Grid.ColumnSpan="3" Style="{StaticResource TextBox}" LostFocus="CapsLockFix_LostFocus"/>
                <TextBlock Grid.Row="4" Grid.Column="0" Margin="0,5,10,10" Text="Дисциплина:" Style="{StaticResource TextBlockTitle}"/>
                <TextBox Grid.Row="4" Grid.Column="1" x:Name="disciplineTextBox" Text="{Binding Path=Title.Discipline,Mode=TwoWay}" Margin="10,5,10,10" Grid.ColumnSpan="3" Style="{StaticResource TextBox}" LostFocus="CapsLockFix_LostFocus"/>
                <TextBlock Grid.Row="6" Grid.Column="0" Margin="0,10,10,5" Text="Преподаватель:" Style="{StaticResource TextBlockTitle}"/>
                <ComboBox Grid.Row="6" Grid.Column="1" x:Name="professorComboBox" Text="{Binding Path=Title.Professor,Mode=TwoWay}" Margin="10,10,10,5" Grid.ColumnSpan="3" Style="{StaticResource ComboBox}"/>
                <TextBlock Grid.Row="7" Grid.Column="0" Margin="0,5,10,10" Text="Год:" Style="{StaticResource TextBlockTitle}"/>
                <TextBox Grid.Row="7" Grid.Column="1" x:Name="yearTextBox" Text="{Binding Path=Title.Year,Mode=TwoWay}" Margin="10,5,10,10" Grid.ColumnSpan="3" Style="{StaticResource TextBox}"/>
            </Grid>
            <Grid Grid.Row="2" Grid.Column="0" x:Name="downPanel" Background="{Binding Path=MainColor,Mode=TwoWay}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto" MinHeight="27.5"/>
                    <RowDefinition Height="100*"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Grid.Column="0" Margin="10 10 10 5" x:Name="elementPanel" Background="{Binding Path=MainColor,Mode=TwoWay}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="3*"/>
                        <ColumnDefinition Width="23.5*"/>
                        <ColumnDefinition Width="23.5*"/>
                        <ColumnDefinition Width="23.5*"/>
                        <ColumnDefinition Width="23.5*"/>
                        <ColumnDefinition Width="0*"/>
                        <ColumnDefinition Width="0*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="100*"/>
                    </Grid.RowDefinitions>
                    <Button Grid.Row="0" Grid.Column="0" Margin="0,0,5,0" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" x:Name="buttonBack" Grid.RowSpan="2" Style="{StaticResource Button}" Click="ButtonBack_Click">
                        <Grid VerticalAlignment="Center">
                            <Polygon Fill="White" Points="1, 7, 9, 0, 9, 14" />
                            <Polygon Fill="White" Points="1, 32, 9, 25, 9, 39" />
                            <Polygon Fill="White" Points="1, 57, 9, 50, 9, 64" />
                        </Grid>
                    </Button>
                    <Button Grid.Row="0" Grid.Column="1" Margin="5,0,5,5" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource Header}" MinHeight="50" Style="{StaticResource Button}"/>
                    <Button Grid.Row="0" Grid.Column="2" Margin="5,0,5,5" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource SubHeader}" Style="{StaticResource Button}"/>
                    <Button Grid.Row="0" Grid.Column="3" Margin="5,0,5,5" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource List}" Style="{StaticResource Button}"/>
                    <Button Grid.Row="0" Grid.Column="4" Margin="5,0,5,5" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource Picture}" Style="{StaticResource Button}"/>
                    <Button Grid.Row="0" Grid.Column="5" Margin="5,0,5,5" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource Table}" Style="{StaticResource Button}"/>
                    <Button Grid.Row="0" Grid.Column="6" Margin="5,0,5,5" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource Code}" Style="{StaticResource Button}"/>
                    <ComboBox Grid.Row="1" Grid.Column="1" MinWidth="10" x:Name="h1ComboBox" ItemsSource="{Binding Path=H1P,Mode=TwoWay}" DisplayMemberPath="Description"  Margin="5,0,5,0" Style="{StaticResource ComboBox}"/>
                    <ComboBox Grid.Row="1" Grid.Column="2" MinWidth="10" x:Name="h2ComboBox" ItemsSource="{Binding Path=H2P,Mode=TwoWay}" DisplayMemberPath="Description" Margin="5,0,5,0" Style="{StaticResource ComboBox}"/>
                    <ComboBox Grid.Row="1" Grid.Column="3" MinWidth="10" x:Name="lComboBox" ItemsSource="{Binding Path=LP,Mode=TwoWay}" DisplayMemberPath="Description" Margin="5,0,5,0" Style="{StaticResource ComboBox}"/>
                    <ComboBox Grid.Row="1" Grid.Column="4" MinWidth="10" x:Name="pComboBox" ItemsSource="{Binding Path=PP,Mode=TwoWay}" DisplayMemberPath="Description" Margin="5,0,5,0" Style="{StaticResource ComboBox}"/>
                    <ComboBox Grid.Row="1" Grid.Column="5" MinWidth="10" x:Name="tComboBox" ItemsSource="{Binding Path=TP,Mode=TwoWay}" DisplayMemberPath="Description" Margin="5,0,5,0" Style="{StaticResource ComboBox}"/>
                    <ComboBox Grid.Row="1" Grid.Column="6" MinWidth="10" x:Name="cComboBox" ItemsSource="{Binding Path=CP,Mode=TwoWay}" DisplayMemberPath="Description" Margin="5,0,5,0" Style="{StaticResource ComboBox}"/>
                    <Button Grid.Row="0" Grid.Column="7" Margin="5,0,0,0" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" x:Name="buttonForward" Grid.RowSpan="2" Style="{StaticResource Button}" Click="ButtonForward_Click">
                        <Grid VerticalAlignment="Center">
                            <Polygon Fill="White" Points="9, 7, 1, 0, 1, 14" />
                            <Polygon Fill="White" Points="9, 32, 1, 25, 1, 39" />
                            <Polygon Fill="White" Points="9, 57, 1, 50, 1, 64" />
                        </Grid>
                    </Button>
                </Grid>
                <Grid Grid.Row="1" Grid.Column="0" x:Name="additionalPanel" Margin="5,2.5,5,2.5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="22*"/>
                        <ColumnDefinition Width="22*"/>
                        <ColumnDefinition Width="16*"/>
                        <ColumnDefinition Width="20*"/>
                        <ColumnDefinition Width="20*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="100*"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Column="0" Grid.ColumnSpan="2" Background="{Binding Path=MainColor,Mode=TwoWay}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock x:Name="elementTBl" TextAlignment="Left" Text="{Binding Path=Displayed,Mode=TwoWay}" Style="{StaticResource TextBlock}"/>
                    </Grid>
                    <Button Grid.Column="3" Margin="0,0,5,0" x:Name="add" Content="{DynamicResource Add}" Visibility="Collapsed" Style="{StaticResource Button}" Click="Add_Click"/>
                    <Button Grid.Column="4" x:Name="toText" Content="К тексту" Style="{StaticResource Button}" Click="ToText_Click"/>
                </Grid>
                <Grid Grid.Row="2" Grid.Column="0" x:Name="SubstitutionPanelRTB" Background="{Binding Path=MainColor,Mode=TwoWay}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="60*"/>
                        <ColumnDefinition Width="40*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="100*"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0" Grid.Column="0" Background="{Binding Path=AdditionalColor,Mode=TwoWay}" x:Name="Substitution">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto"/>
                            <RowDefinition Height="auto"/>
                            <RowDefinition Height="auto"/>
                            <RowDefinition Height="100*"/>
                        </Grid.RowDefinitions>
                        <ComboBox Grid.Row="0" x:Name="TypeSubstitution" Background="{Binding Path=AdditionalColor,Mode=TwoWay}" Style="{StaticResource ComboBox1}" SelectionChanged="TypeSubstitution_SelectionChanged">
                            <ComboBoxItem Content="{DynamicResource Header}"/>
                            <ComboBoxItem Content="{DynamicResource SubHeader}"/>
                            <ComboBoxItem Content="{DynamicResource List}"/>
                            <ComboBoxItem Content="{DynamicResource Picture}"/>
                            <ComboBoxItem Content="{DynamicResource Table}"/>
                            <ComboBoxItem Content="{DynamicResource Code}"/>
                        </ComboBox>
                        <TextBlock Grid.Row="0" x:Name="TypeSubstitutionOn" Visibility="Collapsed" Style="{StaticResource TextBlock}"/>
                        <TextBox Grid.Row="1" x:Name="HeaderSubstitution" FontFamily="Calibri" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" TextChanged="HeaderSubstitution_TextChanged" AllowDrop="True" PreviewDragOver="Win_DragOver" PreviewDragLeave="Win_DragLeave" PreviewDragEnter="Win_DragEnter"/>
                        <TextBlock Grid.Row="2" Text="{DynamicResource Content}" Style="{StaticResource TextBlock}"/>
                        <typeXaml:RTBox Grid.Row="3" x:Name="richTextBoxSubstitution" Style="{StaticResource RichTextBox}" Background="White" SpellCheck.IsEnabled="False" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" TextChanged="RichTextBoxSubstitution_TextChanged" AllowDrop="True" PreviewDragOver="Win_DragOver" PreviewDragLeave="Win_DragLeave" PreviewDragEnter="Win_DragEnter" FontFamily="Calibri">
                            <typeXaml:RTBox.Resources>
                                <Style TargetType="{x:Type Paragraph}">
                                    <Setter x:Name="richTextBoxMargin" Property="Margin" Value="0,0,0,5"/>
                                </Style>
                            </typeXaml:RTBox.Resources>
                        </typeXaml:RTBox>
                        <Grid Grid.Row="3" Visibility="Collapsed" x:Name="panelTable" Background="{Binding Path=MainColor,Mode=TwoWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="10*"/>
                                <RowDefinition Height="90*"/>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0" Grid.Column="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="25*"/>
                                    <ColumnDefinition Width="25*"/>
                                    <ColumnDefinition Width="25*"/>
                                    <ColumnDefinition Width="25*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="100*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Количество строк" Style="{StaticResource TextBlock}"/>
                                <TextBox Grid.Row="0" Grid.Column="1" x:Name="countRows" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" TextChanged="CountRows_TextChanged" PreviewTextInput="NumberValidationTextBox"/>
                                <TextBlock Grid.Row="0" Grid.Column="2" Text="Количество столбцов" Style="{StaticResource TextBlock}"/>
                                <TextBox Grid.Row="0" Grid.Column="3" x:Name="countColumns" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" TextChanged="CountColumns_TextChanged" PreviewTextInput="NumberValidationTextBox"/>
                            </Grid>
                            <Grid Grid.Row="1" Grid.Column="0" x:Name="gridTable"/>
                        </Grid>
                    </Grid>
                    <Grid AllowDrop="True" Grid.Row="0" Grid.Column="1" x:Name="pictureBox" DragEnter="PictureBox_DragEnter" DragLeave="PictureBox_DragLeave" DragOver="PictureBox_DragOver" Drop="PictureBox_Drop">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50*"/>
                            <ColumnDefinition Width="50*"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Row="0" Grid.Column="0" x:Name="doubleOnePB" BorderThickness="3 3 0 3" BorderBrush="White">
                            <Border Grid.Row="0" Grid.Column="1" BorderThickness="4 4 2 4" BorderBrush="Black">
                                <Grid>
                                    <Rectangle x:Name="pictureLeft"/>
                                    <Image Grid.Row="0" Grid.Column="1" Width="auto" Margin="10,0,10,20" Height="70" Source="/Resources/Pictures/Picture.png" Stretch="Fill" />
                                    <TextBlock x:Name="textLeft" TextWrapping="Wrap"  Margin="0,110,0,0" Text="{DynamicResource ForPicture}" HorizontalAlignment="Center" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" VerticalAlignment="Center" Foreground="Black" Style="{StaticResource TextBlock}"/>
                                </Grid>
                            </Border>
                        </Border>
                        <Border Grid.Row="0" Grid.Column="1" x:Name="doubleTwoPB" BorderThickness="0 3 3 3" BorderBrush="White">
                            <Border Grid.Row="0" Grid.Column="1" BorderThickness="2 4 4 4" BorderBrush="Black">
                                <Grid>
                                    <Rectangle x:Name="codeRight"/>
                                    <Image Grid.Row="0" Grid.Column="1" Width="100" Height="145" Source="/Resources/Pictures/Code.png" Stretch="Fill" />
                                    <TextBlock x:Name="textRight" TextWrapping="Wrap" Margin="0,180,0,0" Text="{DynamicResource ForСode}" HorizontalAlignment="Center" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" VerticalAlignment="Center" Foreground="Black" Style="{StaticResource TextBlock}"/>
                                </Grid>
                            </Border>
                        </Border>
                        <Border Grid.Row="0" Grid.Column="0" x:Name="singlePB" Grid.ColumnSpan="2" BorderThickness="3" BorderBrush="White">
                            <Border Grid.Row="0" Grid.Column="1" BorderThickness="4" BorderBrush="{Binding Path=AlternativeColor,Mode=TwoWay}">
                                <Grid>
                                    <Rectangle Fill="{Binding Path=AdditionalColor,Mode=TwoWay}"/>
                                    <TextBlock x:Name="mainText" TextWrapping="Wrap" HorizontalAlignment="Center" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=20}" VerticalAlignment="Center" Foreground="Black" Style="{StaticResource TextBlock}"/>
                                    <Image Grid.Row="0" Grid.Column="1" Visibility="Hidden" x:Name="mainImage" Stretch="Fill" />
                                    <ContentControl Background="White" x:Name="dragDropImage" Style="{StaticResource TheAwesomeXAMLimage}" />
                                </Grid>
                            </Border>
                        </Border>
                    </Grid>
                </Grid>
                <Grid Grid.Row="2" Grid.Column="0" x:Name="TextPanelRTB" Visibility="Collapsed" Background="{Binding Path=MainColor,Mode=TwoWay}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="40*"/>
                        <ColumnDefinition Width="60*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="90*"/>
                        <RowDefinition Height="5*"/>
                        <RowDefinition Height="20"/>
                    </Grid.RowDefinitions>
                    <ListBox Grid.Row="0" AllowDrop="True" ScrollViewer.HorizontalScrollBarVisibility="Disabled" x:Name="lstTest" Grid.Column="0" SelectionChanged="LstTest_SelectionChanged" DragOver="LstTest_DragOver" MouseDown="LstTest_MouseDown">
                        <ListBox.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Вставить(До)" Click="ContextMenuInsertBefore_Click"/>
                                <MenuItem Header="Вставить(После)" Click="ContextMenuInsertAfter_Click"/>
                                <MenuItem Header="Удалить" Click="ContextMenuDelete_Click"/>
                            </ContextMenu>
                        </ListBox.ContextMenu>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="50*" />
                                        <RowDefinition Height="50*" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition Width="auto" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" FontSize="14" FontWeight="Bold" Text="Тип: " HorizontalAlignment="Right" />
                                        <TextBlock Grid.Row="0" Grid.Column="1" FontSize="14" FontWeight="Bold" HorizontalAlignment="Left" Text="{Binding Type}" />
                                    </Grid>
                                    <TextBlock Grid.Row="1" Grid.Column="0" FontSize="16" Grid.ColumnSpan="2" Text="{Binding Description}" />
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <Button Grid.Row="1" Grid.Column="0" Grid.RowSpan="2" x:Name="NewText" Content="Добавить" Style="{StaticResource Button1}" Click="NewText_Click"/>
                    <typeXaml:RTBox Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" x:Name="richTextBox" Style="{StaticResource RichTextBox}" Background="White" SpellCheck.IsEnabled="False" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" TextChanged="RichTextBox_TextChanged" PreviewKeyDown="RichTextBox_PreviewKeyDown" AllowDrop="True" FontFamily="Calibri">
                        <typeXaml:RTBox.Resources>
                            <Style TargetType="{x:Type Paragraph}">
                                <Setter x:Name="richTextBoxMargin" Property="Margin" Value="0,0,0,5"/>
                            </Style>
                        </typeXaml:RTBox.Resources>
                    </typeXaml:RTBox>
                    <TextBlock Grid.Row="2" Grid.Column="1" x:Name="cursorLocationTB" Visibility="Collapsed" HorizontalAlignment="Center" Style="{StaticResource TextBlockTitle}"/>
                </Grid>
            </Grid>
        </Grid>
        <Grid Grid.Row="1" Grid.Column="0" x:Name="SettingsPanel" Visibility="Collapsed">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="20*"/>
                <ColumnDefinition Width="20*"/>
                <ColumnDefinition Width="20*"/>
                <ColumnDefinition Width="20*"/>
                <ColumnDefinition Width="20*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="10*"/>
                <RowDefinition Height="90*"/>
            </Grid.RowDefinitions>
            <Button Grid.Row="0" Grid.Column="0" Margin="4,5,2,0" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource GeneralSettings}" Style="{StaticResource Button}" Click="OpenGeneralisSetiings"/>
            <Button Grid.Row="0" Grid.Column="1" Margin="2,5,2,0" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource PersonalizationSettings}" Style="{StaticResource Button}" Click="OpenPersonalization"/>
            <Button Grid.Row="0" Grid.Column="2" Margin="2,5,2,0" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource ProfileSettings}" Style="{StaticResource Button}" Click="OpenProfile" />
            <Button Grid.Row="0" Grid.Column="3" Margin="2,5,2,0" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource Styles}" Style="{StaticResource Button}"/>
            <Button Grid.Row="0" Grid.Column="4" Margin="2,5,4,0" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource BackSettings}" Style="{StaticResource Button}" Click="ExitSettings"/>
            <ScrollViewer x:Name="GeneralisSetiings" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="5" VerticalScrollBarVisibility="Hidden">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="10"/>
                        <RowDefinition Height="auto" MinHeight="100"/>
                        <RowDefinition Height="auto" MinHeight="100"/>
                        <RowDefinition Height="auto" MinHeight="100"/>
                        <RowDefinition Height="auto" MinHeight="100"/>
                        <RowDefinition Height="auto" MinHeight="100"/>
                        <RowDefinition Height="auto" MinHeight="100"/>
                        <RowDefinition Height="10"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                        <Grid Background="{Binding Path=AdditionalColor,Mode=TwoWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70*"/>
                                <ColumnDefinition Width="40*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource IsAssociate}" Style="{StaticResource TextBlock}"/>
                            <CheckBox Grid.Row="0" Grid.Column="1" x:Name="AssociationWKR" Margin="10 0 0 0" HorizontalAlignment="Left" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Style="{StaticResource CheckBox}" Click="AssociationWKR_Click">
                            <CheckBox.LayoutTransform>
                                <ScaleTransform ScaleX="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" ScaleY="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" />
                            </CheckBox.LayoutTransform>
                            </CheckBox>
                        </Grid>
                    </Border>
                    <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                        <Grid Background="{Binding Path=AdditionalColor,Mode=TwoWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70*"/>
                                <ColumnDefinition Width="40*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource IsSyntaxChecking}" Style="{StaticResource TextBlock}"/>
                            <CheckBox Grid.Row="0" Grid.Column="1" x:Name="SyntaxChecking" Margin="10 0 0 0" HorizontalAlignment="Left" IsChecked="True" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Style="{StaticResource CheckBox}" Click="SyntaxChecking_Checked">
                                <CheckBox.LayoutTransform>
                                    <ScaleTransform ScaleX="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" ScaleY="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" />
                                </CheckBox.LayoutTransform>
                            </CheckBox>
                        </Grid>
                    </Border>
                    <Border Grid.Row="3" Grid.Column="0" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                        <Grid Background="{Binding Path=AdditionalColor,Mode=TwoWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70*"/>
                                <ColumnDefinition Width="40*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource Encoding}" Style="{StaticResource TextBlock}"/>
                            <ComboBox x:Name="Encoding" Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" MinWidth="160" Margin="10 0 10 0" HorizontalAlignment="Left" HorizontalContentAlignment="Center" Style="{StaticResource ComboBox}" SelectionChanged="Encoding_SelectionChanged">
                                <ComboBoxItem Content="{DynamicResource Encoding0}"/>
                                <ComboBoxItem Content="{DynamicResource Encoding1}"/>
                            </ComboBox>
                        </Grid>
                    </Border>
                    <Border Grid.Row="4" Grid.Column="0" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                        <Grid Background="{Binding Path=AdditionalColor,Mode=TwoWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70*"/>
                                <ColumnDefinition Width="40*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource AfterExportingClose}" Style="{StaticResource TextBlock}"/>
                            <CheckBox Grid.Row="0" Grid.Column="1" x:Name="CloseWindow" Margin="10 0 0 0" HorizontalAlignment="Left" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Style="{StaticResource CheckBox}" Click="CloseWindow_Checked">
                                <CheckBox.LayoutTransform>
                                    <ScaleTransform ScaleX="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" ScaleY="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" />
                                </CheckBox.LayoutTransform>
                            </CheckBox>
                        </Grid>
                    </Border>
                    <Border Grid.Row="5" Grid.Column="0" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                        <Grid Background="{Binding Path=AdditionalColor,Mode=TwoWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70*"/>
                                <ColumnDefinition Width="40*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource IsAutoHeader}" Style="{StaticResource TextBlock}"/>
                            <CheckBox Grid.Row="0" Grid.Column="1" x:Name="AutoHeader" Margin="10 0 0 0" HorizontalAlignment="Left" IsChecked="True" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Style="{StaticResource CheckBox}" Click="AutoHeader_Checked">
                                <CheckBox.LayoutTransform>
                                    <ScaleTransform ScaleX="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" ScaleY="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" />
                                </CheckBox.LayoutTransform>
                            </CheckBox>
                        </Grid>
                    </Border>
                    <Border Grid.Row="6" Grid.Column="0" x:Name="AutoHeaderVisibilityText" Visibility="Collapsed" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                        <Grid Background="{Binding Path=AdditionalColor,Mode=TwoWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70*"/>
                                <ColumnDefinition Width="40*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource IsDisplayHeaderInput}" Style="{StaticResource TextBlock}"/>
                            <CheckBox Grid.Row="0" Grid.Column="1" x:Name="AutoHeaderVisibility" Margin="10 0 0 0" HorizontalAlignment="Left" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Style="{StaticResource CheckBox}" Click="AutoHeaderVisibility_Checked" >
                                <CheckBox.LayoutTransform>
                                    <ScaleTransform ScaleX="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" ScaleY="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=1}" />
                                </CheckBox.LayoutTransform>
                            </CheckBox>
                        </Grid>
                    </Border>
                </Grid>
            </ScrollViewer>
            <Grid Grid.Row="1" Grid.Column="0" x:Name="Personalization" Visibility="Collapsed" Grid.ColumnSpan="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="100*"/>
                </Grid.RowDefinitions>
                <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                    <Grid Background="{Binding Path=AdditionalColor,Mode=TwoWay}">
                        <Button Grid.Row="0" Grid.Column="0" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Content="{DynamicResource ByDefault}" Style="{StaticResource Button}" Click="ByDefault"/>
                    </Grid>
                </Border>
                <ScrollViewer Grid.Row="2" Grid.Column="0" VerticalScrollBarVisibility="Hidden">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="auto" MinHeight="100"/>
                            <RowDefinition Height="auto" MinHeight="100"/>
                            <RowDefinition Height="auto" MinHeight="100"/>
                            <RowDefinition Height="auto" MinHeight="100"/>
                            <RowDefinition Height="auto" MinHeight="100"/>
                            <RowDefinition Height="auto" MinHeight="100"/>
                            <RowDefinition Height="10"/>
                        </Grid.RowDefinitions>
                        <Border Grid.Row="1" Grid.Column="0" Background="{Binding Path=AdditionalColor,Mode=TwoWay}" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50*"/>
                                    <ColumnDefinition Width="50*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0" Margin="0 0 10 0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource MainColor}" Style="{StaticResource TextBlock}"/>
                                <xctk:ColorPicker Grid.Row="0" Width="250" MaxHeight="30" HorizontalAlignment="Left" Grid.Column="1" x:Name="mainColor" SelectedColor="{Binding MainColor}" Closed="MainColor_ContextMenuClosing"/>
                            </Grid>
                        </Border>
                        <Border Grid.Row="2" Grid.Column="0" Background="{Binding Path=AdditionalColor,Mode=TwoWay}" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50*"/>
                                    <ColumnDefinition Width="50*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0" Margin="0 0 10 0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource ComplementaryСolor}" Style="{StaticResource TextBlock}"/>
                                <xctk:ColorPicker Grid.Row="0" Width="250" MaxHeight="30" HorizontalAlignment="Left" Grid.Column="2" x:Name="additionalColor" SelectedColor="{Binding AdditionalColor}" Closed="AdditionalColor_ContextMenuClosing"/>
                            </Grid>
                        </Border>
                        <Border Grid.Row="3" Grid.Column="0" Background="{Binding Path=AdditionalColor,Mode=TwoWay}" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50*"/>
                                    <ColumnDefinition Width="50*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0" Margin="0 0 10 0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource AlternativeСolor}" Style="{StaticResource TextBlock}"/>
                                <xctk:ColorPicker Grid.Row="0" Width="250" MaxHeight="30" HorizontalAlignment="Left" Grid.Column="1" x:Name="alternativeColor" SelectedColor="{Binding AlternativeColor}" Closed="AlternativeColor_ContextMenuClosing"/>
                            </Grid>
                        </Border>
                        <Border Grid.Row="4" Grid.Column="0" Background="{Binding Path=AdditionalColor,Mode=TwoWay}" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50*"/>
                                    <ColumnDefinition Width="50*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0" Margin="0 0 10 0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource HoverColor}" Style="{StaticResource TextBlock}"/>
                                <xctk:ColorPicker Grid.Row="0" Width="250" MaxHeight="30" HorizontalAlignment="Left" Grid.Column="1" x:Name="hoverColor" SelectedColor="{Binding HoverColor}" Closed="HoverColor_ContextMenuClosing"/>
                            </Grid>
                        </Border>
                        <Border Grid.Row="5" Grid.Column="0" Background="{Binding Path=AdditionalColor,Mode=TwoWay}" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50*"/>
                                    <ColumnDefinition Width="50*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0" Margin="0 0 10 0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource FontSize}" Style="{StaticResource TextBlock}"/>
                                <Slider Grid.Row="0" Grid.Column="1" IsSnapToTickEnabled="True" HorizontalAlignment="Left" TickPlacement="BottomRight" AutoToolTipPlacement="BottomRight" Minimum="0" Maximum="54" MinWidth="250" VerticalAlignment="Center" x:Name="fontSize" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" ValueChanged="FontSize_ValueChanged"/>
                            </Grid>
                        </Border>
                        <Border Grid.Row="6" Grid.Column="0" Background="{Binding Path=AdditionalColor,Mode=TwoWay}" Style="{StaticResource BorderGroupBox}" Margin="10 10 10 0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50*"/>
                                    <ColumnDefinition Width="50*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0" Margin="0 0 10 0" TextWrapping="Wrap" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource Language}" Style="{StaticResource TextBlock}"/>
                                <ComboBox x:Name="language" MinWidth="250" Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left" HorizontalContentAlignment="Center" Style="{StaticResource ComboBox}" SelectionChanged="Language_SelectionChanged">
                                    <ComboBoxItem>Русский</ComboBoxItem>
                                    <ComboBoxItem>English</ComboBoxItem>
                                    <ComboBoxItem>Беларускі</ComboBoxItem>
                                    <ComboBoxItem>Français</ComboBoxItem>
                                    <ComboBoxItem>Deutsch</ComboBoxItem>
                                    <ComboBoxItem>中文</ComboBoxItem>
                                </ComboBox>
                            </Grid>
                        </Border>
                    </Grid>
                </ScrollViewer>
            </Grid>
            <Grid x:Name="Profile" Visibility="Collapsed" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="65*"/>
                    <RowDefinition Height="35*"/>
                </Grid.RowDefinitions>
                <GroupBox Grid.Row="0"  Margin="10 10 10 5">
                    <GroupBox.Header>
                        <TextBlock Text="{DynamicResource You}" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" TextAlignment="Center" HorizontalAlignment="Center" Style="{StaticResource TextBlockRounded}"/>
                    </GroupBox.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Hidden">
                        <Grid HorizontalAlignment="Left">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto"/>
                                <ColumnDefinition Width="auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Margin="0 0 3 10" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource FirstName}" Style="{StaticResource TextBlock}"/>
                            <TextBox x:Name="FirstName" Grid.Row="0" Margin="0 0 0 10" Grid.Column="1" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" Style="{StaticResource TextBox}" TextChanged="FirstName_TextChanged"/>
                            <TextBlock Grid.Row="1" Grid.Column="0" Margin="0 0 3 10"  TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource LastName}" Style="{StaticResource TextBlock}"/>
                            <TextBox x:Name="LastName" Grid.Row="1" Margin="0 0 0 10" Grid.Column="1" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" Style="{StaticResource TextBox}" TextChanged="LastName_TextChanged"/>
                            <TextBlock Grid.Row="2" Grid.Column="0" Margin="0 0 3 10"  TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource MiddleName}" Style="{StaticResource TextBlock}"/>
                            <TextBox x:Name="MiddleName" Grid.Row="2" Margin="0 0 0 10" Grid.Column="1" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" Style="{StaticResource TextBox}" TextChanged="MiddleName_TextChanged"/>
                            <TextBlock Grid.Row="3" Grid.Column="0" Margin="0 0 3 10"  TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource Universitet}" Style="{StaticResource TextBlock}"/>
                            <ComboBox x:Name="Universitet" Grid.Row="3" Margin="0 0 0 10" Grid.Column="1" HorizontalContentAlignment="Center" Style="{StaticResource ComboBox}" SelectionChanged="Universitet_SelectionChanged"/>
                            <TextBlock Grid.Row="4" Grid.Column="0" Margin="0 0 3 10"  TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource Faculty}" Style="{StaticResource TextBlock}"/>
                            <ComboBox x:Name="Faculty" Grid.Row="4" Margin="0 0 0 10" Grid.Column="1" HorizontalContentAlignment="Center" Style="{StaticResource ComboBox}" SelectionChanged="Faculty_SelectionChanged"/>
                            <TextBlock Grid.Row="5" Grid.Column="0" Margin="0 0 3 10"  TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource Cours}" Style="{StaticResource TextBlock}"/>
                            <ComboBox x:Name="Cours" Grid.Row="5" Margin="0 0 0 10" Grid.Column="1" HorizontalContentAlignment="Center" Style="{StaticResource ComboBox}" SelectionChanged="Cours_SelectionChanged"/>
                            <TextBlock Grid.Row="6" Grid.Column="0" Margin="0 0 3 10"  TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource Group}" Style="{StaticResource TextBlock}"/>
                            <ComboBox x:Name="Group" Grid.Row="6" Margin="0 0 0 10" Grid.Column="1" HorizontalContentAlignment="Center" Style="{StaticResource ComboBox}" SelectionChanged="Group_SelectionChanged"/>
                            <TextBlock Grid.Row="7" Grid.Column="0" Margin="0 0 3 10"  TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource Shifr}" Style="{StaticResource TextBlock}"/>
                            <TextBox x:Name="Shifr" Grid.Row="7" Margin="0 0 0 10" Grid.Column="1" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" Style="{StaticResource TextBox}" TextChanged="Shifr_TextChanged"/>
                        </Grid>
                    </ScrollViewer>
                </GroupBox>
                <GroupBox Grid.Row="1" Margin="10 10 10 5">
                    <GroupBox.Header>
                        <TextBlock Text="{DynamicResource Companion}" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" TextAlignment="Center" HorizontalAlignment="Center" Style="{StaticResource TextBlockRounded}"/>
                    </GroupBox.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Hidden">
                        <Grid HorizontalAlignment="Left">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto"/>
                                <ColumnDefinition Width="auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Margin="0 0 3 10" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource FirstName}" Style="{StaticResource TextBlock}"/>
                            <TextBox x:Name="FirstNameCoop" Grid.Row="0" Grid.Column="1" Margin="0 0 0 10" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" Style="{StaticResource TextBox}" TextChanged="FirstNameCoop_TextChanged"/>
                            <TextBlock Grid.Row="1" Grid.Column="0" Margin="0 0 3 10" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource LastName}" Style="{StaticResource TextBlock}"/>
                            <TextBox x:Name="LastNameCoop" Grid.Row="1" Grid.Column="1" Margin="0 0 0 10" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" Style="{StaticResource TextBox}" TextChanged="LastNameCoop_TextChanged"/>
                            <TextBlock Grid.Row="2" Grid.Column="0" Margin="0 0 3 10" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource MiddleName}" Style="{StaticResource TextBlock}"/>
                            <TextBox x:Name="MiddleNameCoop" Grid.Row="2" Grid.Column="1" Margin="0 0 0 10" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" Style="{StaticResource TextBox}" TextChanged="MiddleNameCoop_TextChanged"/>
                            <TextBlock Grid.Row="3" Grid.Column="0" Margin="0 0 3 10" TextAlignment="Right" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=16}" Text="{DynamicResource Shifr}" Style="{StaticResource TextBlock}"/>
                            <TextBox x:Name="ShifrCoop" Grid.Row="3" Grid.Column="1" Margin="0 0 0 10" FontSize="{Binding Path=FontSize,Mode=TwoWay,Converter={StaticResource fontConverter},ConverterParameter=14}" Style="{StaticResource TextBox}" TextChanged="ShifrCoop_TextChanged"/>
                        </Grid>
                    </ScrollViewer>
                </GroupBox>
            </Grid>
        </Grid>
        <Grid Grid.Row="1" Grid.Column="0" x:Name="DrawingPanel" Visibility="Collapsed">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="5*"/>
                <ColumnDefinition Width="95*"/>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0" Background="Yellow">
                
            </Grid>
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="10*"/>
                    <RowDefinition Height="90*"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Background="Yellow">
                    
                </Grid>
                <Grid Grid.Row="1">
                    <Canvas Name="DrawingTarget" Background="Transparent" MouseLeftButtonDown="DrawingMouseDown" MouseLeftButtonUp="DrawingMouseUp" MouseMove="DrawingMouseMove"/>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Window>